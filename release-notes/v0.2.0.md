# Release Notes - v0.2.0

**Release Date:** February 14, 2026

## ğŸ‰ New Features

### User Management API

Added comprehensive user management endpoints for server-side admin operations:

- **GET** `/user/:clientID/:userID` - Retrieve specific user by ID
  - Requires client secret authentication
  - Returns user identifier, session data (public/private), and metadata
- **PUT** `/user/:clientID/:userID` - Update user by ID
  - Supports updating identifier, public session, and private session
  - Fields are optional and merged with existing data
  - Requires client secret authentication
- **DELETE** `/user/:clientID/:userID` - Delete user by ID
  - Permanently removes user from the system
  - Requires client secret authentication
- **GET** `/users/:clientID` - List users with pagination
  - Query params: `?page=1&limit=10`
  - Returns paginated results with total count
  - Requires client secret authentication

### Session Management API

Added RESTful endpoints for managing user session data:

**Public Session Endpoints** (accessible from browser with Bearer token):

- **GET** `/session/public/:clientID` - Get public session data
- **PATCH** `/session/public/:clientID` - Update public session data (merged)
- **DELETE** `/session/public/:clientID` - Clear public session data

**Private Session Endpoints** (server-side only, requires secret + token):

- **GET** `/session/private/:clientID` - Get private session data
- **PATCH** `/session/private/:clientID` - Update private session data (merged)
- **DELETE** `/session/private/:clientID` - Clear private session data

### Utility Endpoints

- **GET** `/health` - Health check endpoint
- **GET** `/version` - Returns OpenAuthster issuer version
- **GET** `/cleanup` - Clear authentication cookies (for testing)

## ğŸ”§ Major Improvements

### Hono Framework Migration

Completely refactored all endpoints to use [Hono](https://hono.dev/) framework:

- âœ¨ **Cleaner code organization** - Better separation of concerns
- ğŸš€ **Improved performance** - Faster routing and middleware handling
- ğŸ›¡ï¸ **Type safety** - Full TypeScript support with typed context
- ğŸ”Œ **Middleware chain** - Elegant request processing pipeline
- ğŸ“ **Better error handling** - Centralized error management with RequestError class

### Enhanced Error Handling

- Introduced `RequestError` class for structured error responses
- Automatic error logging to database via `insertLog`
- Detailed error context including stack traces, request headers, and response status
- Proper HTTP status codes for different error scenarios

### CORS Improvements

- Automatic CORS header management via middleware
- Configurable origin validation per project
- Proper preflight (OPTIONS) request handling
- Credential support for authenticated requests

### Authentication Middleware

- Streamlined authentication flow with middleware chain
- Cookie-based parameter persistence (clientID, copyID, inviteID)
- Project validation and loading
- Admin email verification for WebUI access

## ğŸ”’ Security Enhancements

- Token validation using `ensureToken()` helper
- Secret validation using `ensureSecret()` helper
- Separate authentication for public vs private session access
- Request header validation for Authorization and X-Client-Secret

## ğŸ“ API Changes

### Breaking Changes

âš ï¸ **Compatibility Requirements:**

- **Must update** `openauthster-shared` to version **0.2.x**
- **Must update** `openauth-webui` to version **0.2.x**

These packages include matching client SDK and types for the new API endpoints.

### Non-Breaking Additions

- Database schema unchanged (no migration required)

## ğŸ› ï¸ Internal Improvements

- Better code organization with helper function separation
- Improved type safety across all endpoints
- Centralized token and secret extraction utilities
- Enhanced logging and debugging capabilities
- Cleaner middleware composition

## ğŸ› Bug Fixes

- Fixed CORS issues with well-known endpoints
- Improved error responses with proper status codes
- Better handling of missing or invalid authentication
- Fixed cookie expiration handling in cleanup endpoint

## ğŸ“¦ Dependencies

- Added `hono` as core framework dependency
- Updated compatibility with `openauthster-shared@0.2.0`

## ğŸš€ Migration Guide

To upgrade from v0.1.x to v0.2.0:

1. **Update dependencies:**

   ```bash
   bun update openauthster-shared@0.2.0
   ```

2. **Update client applications:**
   - Update `openauthster-shared` package in client apps to 0.2.x
   - Update `openauth-webui` to 0.2.x if using the management dashboard

3. **No database migration required** - existing data remains compatible

4. **Test new endpoints** (optional):

   ```bash
   # Health check
   curl https://your-issuer.com/health

   # Version check
   curl https://your-issuer.com/version
   ```

## ğŸ“š Documentation

- Updated README with API endpoint documentation
- Added comprehensive endpoint reference
- Included authentication requirements for each endpoint

---

For detailed API usage, see the [README](../README.md) and [openauthster-shared documentation](../../openauth-webui-shared-types/README.md).
